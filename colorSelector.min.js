var colorSelector=function(e,a,c,f){this.x=e;this.y=a;this.mdOnBlock=this.mdOnSideBar=!1;this.size=c;this.selectedColor=16711680;this.selectedColorX=1;this.selectedColorY=0;this.baseColor=16711680;this.baseColorRed=(this.baseColor&16711680)>>16;this.baseColorGreen=(this.baseColor&65280)>>8;this.baseColorBlue=this.baseColor&255;var b=document.createElement("canvas");b.width=c;b.height=c;b.onselectstart=function(){return!1};document.body.appendChild(b);b.className="colorSelector";this.can=b;this.con=
b.getContext("2d");b.style.position="absolute";b.style.border="solid 1px #ccc";b.style.padding="10px";b.style.borderRadius="5px";b.style.left=e+"px";b.style.top=a+"px";this.text=document.createElement("input");this.text.type="text";this.text.style.position="absolute";this.text.style.width=c/2+"px";this.text.style.font="'Arial' 18px";this.text.style.left=e+2*(c/7.5)+"px";this.text.style.top=a+c-18+"px";document.body.appendChild(this.text);this.rendercolorSelector();var d=this,g=function(a){a.preventDefault();
a.stopPropagation();var e=a.pageX-d.x-10,a=a.pageY-d.y-10;e>c-c/10?d.mdOnSideBar=!0:e<c-c/7.5&&a<c-c/7.5?d.mdOnBlock=!0:e<c/7.5&&a>c-c/10&&(f(d.selectedColor),b.removeEventListener("mousedown",g),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",i),document.body.removeChild(b),document.body.removeChild(d.text))},h=function(a){var b=a.pageX-d.x-10,a=a.pageY-d.y-10;if(d.mdOnSideBar)b=a/c,d.baseColor=d.getBaseColor(1<=b?0.99:0>b?0:b),d.baseColorRed=(d.baseColor&16711680)>>
16,d.baseColorGreen=(d.baseColor&65280)>>8,d.baseColorBlue=d.baseColor&255,b=d.selectedColorX,a=d.selectedColorY,d.selectedColor=d.getColorAt(b,a),d.rendercolorSelector();else if(d.mdOnBlock){var e=c-c/7.5,b=b/e,a=a/e;d.selectedColorX=1>=b?0<=b?b:0:1;d.selectedColorY=1>=a?0<=a?a:0:1;d.selectedColor=d.getColorAt(d.selectedColorX,d.selectedColorY);d.rendercolorSelector()}},i=function(){d.mdOnBlock=!1;d.mdOnSideBar=!1};b.addEventListener("mousedown",g);document.addEventListener("mousemove",h);document.addEventListener("mouseup",
i)};
colorSelector.prototype.rendercolorSelector=function(){var e=function(a){for(a=a.toString(16);6>a.length;)a="0"+a;return a},a=this.size,c=this.con;c.fillStyle="#fff";c.fillRect(0,0,a,a);for(var f=0;1>f;f+=1/a){var b=this.getBaseColor(f);c.fillStyle="#"+e(Math.round(b));c.fillRect(a-a/10,a*f,a/10,1)}for(var b=a-a/7.5,d=c.getImageData(0,0,b,b),g=d.data,h=this.baseColorRed,i=this.baseColorGreen,n=this.baseColorBlue,j=f=0;j<b;j++)for(var k=j/b,l=0;l<b;l++){var m=l/b;g[f]=(h+(255-h)*k)*m;g[f+1]=(i+(255-
i)*k)*m;g[f+2]=(n+(255-n)*k)*m;g[f+3]=255;f+=4}c.putImageData(d,0,0);f=this.getColorAt(this.selectedColorX,this.selectedColorY);c.strokeStyle="#"+e(255-((f&16711680)>>16)<<16|255-((f&65280)>>8)<<8|255-(f&255));c.lineWidth=0.01*a;c.beginPath();c.arc(this.selectedColorX*b,this.selectedColorY*b,0.05*a,0,2*Math.PI,!0);c.closePath();c.stroke();c.strokeStyle="";c.fillStyle="#"+e(this.selectedColor);c.fillRect(0,a-a/10,a/7.5,a/10);this.text.value=e(this.selectedColor)};
colorSelector.prototype.getColorAt=function(e,a){var c=this.baseColorRed,f=this.baseColorGreen,b=this.baseColorBlue;return(c+(255-c)*a)*e<<16|(f+(255-f)*a)*e<<8|(b+(255-b)*a)*e};
colorSelector.prototype.getBaseColor=function(e){e*=6;switch(Math.floor(e)){case 0:return 16711680+255*(e%1);case 1:return 16711935-(Math.floor(255*(e%1))<<16);case 2:return 255+(Math.floor(255*(e%1))<<8);case 3:return 65535-Math.floor(255*(e%1));case 4:return 65280+(Math.floor(255*(e%1))<<16);case 5:return 16776960-(Math.floor(255*(e%1))<<8)}};
